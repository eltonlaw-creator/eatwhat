<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ä»Šå¤©åƒå•¥</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Microsoft Yahei",sans-serif; background:#fff7ee; margin:0; color:#0f172a; }
    .stage { width:min(560px,92vw); margin:28px auto 10px; position:relative; }
    canvas#wheel { width:100%; aspect-ratio:1/1; background:#fff; border-radius:50%; border:8px solid #e5e7eb; display:block; }
    /* æŒ‡é’ˆåœ¨12ç‚¹æ–¹å‘ï¼Œå°–ç«¯æœä¸‹ */
    .pointer { position:absolute; top:-28px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:18px solid transparent; border-right:18px solid transparent; border-top:32px solid #ef4444; }
    .controls { text-align:center; margin-top: 12px; }
    button { margin: 6px; padding: 10px 18px; font-size: 16px; border:0; border-radius:10px; cursor:pointer; color:#fff; background:linear-gradient(135deg,#ffa7c8,#ff8fab); box-shadow:0 6px 16px rgba(255,143,171,.35);} 
    button.alt{ background:linear-gradient(135deg,#93c5fd,#a7f3d0);} 
    #result { text-align:center; font-size:32px; font-weight:900; margin-top:12px; color:#111827; }
    #itemList { display:flex; flex-wrap:wrap; gap:6px; margin:16px auto; width:min(560px,92vw); justify-content:center; }
    .tag { background:#f8fafc; padding:6px 10px; border-radius:8px; border:1px solid #e2e8f0; }
    footer { text-align:center; margin:16px; color:#334155; font-size:12px; }
    #confetti { position:fixed; inset:0; pointer-events:none; }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="stage">
    <i class="pointer"></i>
    <canvas id="wheel" width="700" height="700"></canvas>
  </div>
  <div class="controls">
    <button id="spinBtn">å¼€å§‹è½¬ï¼</button>
    <button id="refreshBtn" class="alt">æ¢ä¸€æ‰¹(10)</button>
  </div>
  <div id="result">ç‚¹å‡»å¼€å§‹è½¬ï¼</div>
  <div class="hint" style="text-align:center;color:#64748b;font-size:13px">ç‚¹å‡»â€œæ¢ä¸€æ‰¹(10)â€å¯é‡æŠ½ã€‚</div>
  <div id="itemList"></div>
  <footer>Created by Elton</footer>

<script>
  const defaultPool = [
    "è‚‰éª¨èŒ¶ Bak Kut Teh","ç‚’ç²¿æ¡ Char Kway Teow","ç¦å»ºé¢ Hokkien Mee","äº‘åé¢ Wantan Mee","å¹²æé¢ Dry Noodles",
    "ç ‚ç…²é¸¡é¥­ Claypot Chicken Rice","å’¸è›‹é¸¡ Salted Egg Chicken","æµ·å—é¸¡é¥­ Hainanese Chicken Rice","å’–å–±é¢ Curry Mee","å»æ²™ Laksa",
    "ç“¦ç…²äºšå‚é±¼ Assam Fish","æ¸…è’¸é‡‘ç›®é²ˆ Steamed Seabass","ç…²ä»”é¥­ Claypot Rice","å’•å™œè‚‰ Sweet & Sour Pork","é±¼å¤´ç±³ç²‰ Fish Head Bee Hoon",
    "ç‚’ç±³ç²‰ Fried Bee Hoon","ç²¥å“ Congee","çƒ§è…Šé¥­ Roast Meat Rice","è’¸ç‚¹ Dim Sum",
    "æ¤°æµ†é¥­ Nasi Lemak","ä»å½“ç‰›è‚‰ Beef Rendang","é©¬æ¥ç‚’é¢ Mee Goreng Mamak","ç‚’é¥­ Nasi Goreng","æ²™çˆ¹ Satay",
    "äºšå‚å»æ²™ Assam Laksa","ç½—æƒ¹ Rojak","ä¹Œè¾¾ Otak-otak","å‚å³‡é±¿é±¼ Sambal Sotong","å‚å³‡ç©ºå¿ƒèœ Kangkung Belacan",
    "ç”˜æ¦œç‚¸é¸¡ Ayam Goreng Kampung","é©¬æ¥çƒ¤é±¼ Ikan Bakar","é©¬æ¥ç¾Šæ‚ Sup Kambing","é»„å§œé¥­ Nasi Kunyit",
    "å°åº¦ç…é¥¼ Roti Canai","é£é¥¼ Roti Tisu","å°åº¦ç”©é¥¼ Murtabak","æ‰æ‹…é¥­ Nasi Kandar","ç‚­ç‚‰çƒ¤é¸¡ Tandoori Chicken",
    "çƒ¤é¥¼é…å’–å–± Naan Set","é¦™æ–™é¥­ Briyani","é©¬æ²™æ‹‰å¤šè¨ Masala Dosa",
    "æ²™å·´æµ·é²œ Sabah Seafood","ç ‚æ‹‰è¶Šå¹²ç›˜é¢ Sarawak Kolo Mee","å®¢å®¶é¢ Hakka Mee","å»æ²™æµ·é²œé¢ Seafood Laksa",
    "ç…è•Š Cendol","çº¢è±†å†° ABC","ç‚¸é¦™è•‰ Pisang Goreng","å’–æ¤°é¢åŒ… Kaya Toast","åŠç”Ÿç†Ÿè›‹ Soft-boiled Eggs",
    "æ³°å¼ç½—å‹’ç‚’è‚‰ Pad Kra Pao","å†¬é˜´åŠŸ Tom Yum","æ³°å¼çŒªè„šé¥­ Thai Pork Leg Rice","æ‰“æŠ›é¸¡ Basil Chicken Rice",
    "è¶Šå—æ²³ç²‰ Pho","è¶Šå—æ˜¥å· Spring Roll","èŠ’æœç³¯ç±³é¥­ Mango Sticky Rice",
    "é¸¡æ’é¥­ Chicken Chop","ç‚¸é±¼è–¯æ¡ Fish & Chips","é»‘æ¤’ç‰›æ’ Black Pepper Steak","å¥¶æ²¹æ„é¢ Cream Pasta","æŠ«è¨ Pizza",
    "æ±‰å ¡ Burger","çƒ­ç‹— Hotdog","å¥¶æ²¹è˜‘è‡æ±¤ Mushroom Soup","å‡¯æ’’æ²™æ‹‰ Caesar Salad","è’œé¦™é¢åŒ… Garlic Bread",
    "å®«ä¿é¸¡ä¸ Kung Pao Chicken","é±¼é¦™è‚‰ä¸ Yu Xiang Pork","å›é”…è‚‰ Twice-cooked Pork","é…¸èœé±¼ Suan Cai Yu","é‡åº†å°é¢ Chongqing Noodles",
    "æ‹…æ‹…é¢ Dan Dan Noodles","éº»è¾£é¦™é”… Mala Dry Pot","é¦™è¾£èŸ¹ Spicy Crab","å£æ°´é¸¡ Mouth-watering Chicken","æ‰‹æŠ“é¥­ Nasi Arab/Bukhari",
    "é¸¡é¥­ç²’ Chicken Rice Ball","è€é¼ ç²‰ Lou Shu Fan","é…¿è±†è… Yong Tau Foo","æ¿é¢ Pan Mee","ç‚’ç²¿è§’ Char Kuey Kak",
    "é©¬æ¥ç³• Kuih","å¨˜æƒ¹ç³• Nyonya Kuih","å’–å–±è§’ Curry Puff","å¤è‚‰é¥­ Braised Pork Rice","ä¸œç‚ç‚’é¥­ Tom Yum Fried Rice"
  ];

  const wheel = document.getElementById('wheel');
  const ctx = wheel.getContext('2d');
  const itemList = document.getElementById('itemList');
  const resultDom = document.getElementById('result');
  const spinBtn = document.getElementById('spinBtn');
  const refreshBtn = document.getElementById('refreshBtn');
  const confetti = document.getElementById('confetti');
  const cctx = confetti.getContext('2d');

  let pool = [...defaultPool];
  let items = pickRandom10(pool);
  let angle = 0; let spinning = false; let startAngle=0, targetAngle=0, startTime=0, duration=0;
  let lastTick = -1; let audioCtx = null; let confs = [];

  function pickRandom10(pool){ const arr=[...pool]; for(let i=arr.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr.slice(0,10);} 

  function getIndex(){
    const n = items.length; const slice = Math.PI*2/n;
    const pointerAngle = -Math.PI/2; // 12ç‚¹æœä¸‹
    let rel = (pointerAngle - angle) % (Math.PI*2);
    if (rel < 0) rel += Math.PI*2;
    return Math.floor(rel / slice) % n;
  }

  function easeOutCubic(t){ return 1-Math.pow(1-t,3); }
  function playTick(){ try{ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); if(audioCtx.state==='suspended') audioCtx.resume(); const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type='square'; o.frequency.value=1000; g.gain.value=0.02; o.connect(g).connect(audioCtx.destination); o.start(); setTimeout(()=>o.stop(),40);}catch(e){} }

  function drawWheel(){
    const W=wheel.width, H=wheel.height; const cx=W/2, cy=H/2, r=Math.min(W,H)/2-12; ctx.clearRect(0,0,W,H);
    const n=items.length; const slice=Math.PI*2/Math.max(n,1);
    for(let i=0;i<n;i++){
      const start=angle+i*slice, end=start+slice, mid=(start+end)/2; const hue=(i*360/n)|0; 
      const c1=`hsl(${hue} 80% 65%)`, c2=`hsl(${(hue+24)%360} 80% 55%)`; 
      const grad=ctx.createLinearGradient(cx+Math.cos(start)*r, cy+Math.sin(start)*r, cx, cy); grad.addColorStop(0,c1); grad.addColorStop(1,c2);
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,r,start,end); ctx.closePath(); ctx.fillStyle=grad; ctx.fill(); ctx.strokeStyle='rgba(255,255,255,.5)'; ctx.lineWidth=1.2; ctx.stroke();
      ctx.save(); ctx.translate(cx+Math.cos(mid)*(r*0.72), cy+Math.sin(mid)*(r*0.72)); ctx.rotate(mid+Math.PI/2); ctx.fillStyle='#fff'; ctx.font='700 15px system-ui'; const label=items[i]; const txt=label.length>8?label.slice(0,8)+'â€¦':label; ctx.textAlign='center'; ctx.fillText(txt,0,5); ctx.restore();
    }
    ctx.beginPath(); ctx.arc(cx,cy,58,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill(); ctx.strokeStyle='#e5e7eb'; ctx.lineWidth=3; ctx.stroke(); ctx.fillStyle='#111827'; ctx.font='700 16px system-ui'; ctx.textAlign='center'; ctx.fillText('ä»Šå¤©',cx,cy-4); ctx.fillStyle='#ef4444'; ctx.font='900 20px system-ui'; ctx.fillText('åƒå•¥',cx,cy+20);
  }

  function renderList(){ itemList.innerHTML=''; items.forEach(it=>{ const d=document.createElement('div'); d.className='tag'; d.textContent=it; itemList.appendChild(d); }); }

  function animate(){ if(!spinning) return; const t=Math.min((performance.now()-startTime)/duration,1); angle = startAngle + (targetAngle-startAngle)*easeOutCubic(t); const idx=getIndex(); if(idx!==lastTick){ lastTick=idx; playTick(); } drawWheel(); if(t<1){ requestAnimationFrame(animate); } else { spinning=false; finishSpin(); } }
  function spin(){ if(spinning||items.length===0) return; spinning=true; lastTick=-1; const extra=6+Math.random()*3; startAngle=angle; targetAngle=angle+extra*Math.PI*2+Math.random()*Math.PI*2; duration=2600+Math.random()*800; startTime=performance.now(); requestAnimationFrame(animate); }
  function finishSpin(){ const {label}=getResult(); resultDom.innerHTML = `ğŸ¯ å‘½è¿å®‰æ’ï¼š<b style=\"font-size:28px\">${label}</b>ï¼`; boomConfetti(); }
  function getResult(){ return { index:getIndex(), label: items[getIndex()] }; }

  function boomConfetti(){
    confetti.width = innerWidth; confetti.height = innerHeight;
    confs = new Array(160).fill(0).map(()=>({
      x: innerWidth/2 + (Math.random()-0.5)*200,
      y: innerHeight/3 + (Math.random()-0.5)*120,
      r: 2 + Math.random()*3,
      vx: (Math.random()-0.5)*6,
      vy: -Math.random()*7,
      g: 0.18 + Math.random()*0.22,
      life: 60 + (Math.random()*60|0),
      color: `hsl(${(Math.random()*360)|0} 80% 60%)`
    }));
    drawConfetti();
  }
  function drawConfetti(){
    cctx.clearRect(0,0,confetti.width,confetti.height);
    confs.forEach(p=>{ cctx.beginPath(); cctx.arc(p.x,p.y,p.r,0,Math.PI*2); cctx.fillStyle=p.color; cctx.fill(); p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.life--; });
    confs = confs.filter(p=> p.y < confetti.height+10 && p.life>0 );
    if(confs.length) requestAnimationFrame(drawConfetti);
  }
  addEventListener('resize',()=>{ confetti.width=innerWidth; confetti.height=innerHeight; });

  spinBtn.addEventListener('click', spin);
  refreshBtn.addEventListener('click', ()=>{ items=pickRandom10(pool); drawWheel(); renderList(); resultDom.textContent='å·²æ¢ä¸€æ‰¹ï¼ç‚¹å¼€å§‹è½¬ï½'; });

  drawWheel(); renderList();
</script>
</body>
</html>
