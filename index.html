<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ä»Šå¤©åƒå•¥</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Microsoft Yahei",sans-serif; background:#fff7ee; margin:0; color:#0f172a; }
    .stage { width:min(560px,92vw); margin:28px auto 10px; position:relative; }
    canvas#wheel { width:100%; aspect-ratio:1/1; background:#fff; border-radius:50%; border:8px solid #e5e7eb; display:block; }
    /* æŒ‡é’ˆåœ¨12ç‚¹æ–¹å‘ï¼Œå°–ç«¯æœä¸‹ */
    .pointer { position:absolute; top:-28px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:18px solid transparent; border-right:18px solid transparent; border-top:32px solid #ef4444; }
    .controls { text-align:center; margin-top: 12px; }
    button { margin: 6px; padding: 10px 18px; font-size: 16px; border:0; border-radius:10px; cursor:pointer; color:#fff; background:linear-gradient(135deg,#ffa7c8,#ff8fab); box-shadow:0 6px 16px rgba(255,143,171,.35);} 
    button.alt{ background:linear-gradient(135deg,#93c5fd,#a7f3d0);} 
    #result { text-align:center; font-size:32px; font-weight:900; margin-top:12px; color:#111827; }
    #itemList { display:flex; flex-wrap:wrap; gap:6px; margin:16px auto; width:min(560px,92vw); justify-content:center; }
    .tag { background:#f8fafc; padding:6px 10px; border-radius:8px; border:1px solid #e2e8f0; }
    footer { text-align:center; margin:16px; color:#334155; font-size:12px; }
    #confetti { position:fixed; inset:0; pointer-events:none; }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="stage">
    <i class="pointer"></i>
    <canvas id="wheel" width="700" height="700"></canvas>
  </div>
  <div class="controls">
    <button id="spinBtn">å¼€å§‹è½¬ï¼</button>
    <button id="refreshBtn" class="alt">æ¢ä¸€æ‰¹(10)</button>
  </div>
  <div id="result">ç‚¹å‡»å¼€å§‹è½¬ï¼</div>
  <div class="hint" style="text-align:center;color:#64748b;font-size:13px">ç‚¹å‡»â€œæ¢ä¸€æ‰¹(10)â€å¯é‡æŠ½ã€‚</div>
  <div id="itemList"></div>
  <footer>Created by Elton</footer>

<script>
const defaultPool = [
  // â€”â€” åäººå°è´©/ç…®ç‚’ (80 é“) â€”â€”
  "ç‚’ç²¿æ¡ Char Kway Teow","ç¦å»ºé¢ Hokkien Mee","äº‘åé¢ Wantan Mee","å¹²æé¢ Dry Noodles","ç ‚ç…²é¸¡é¥­ Claypot Chicken Rice",
  "æµ·å—é¸¡é¥­ Hainanese Chicken Rice","å’–å–±é¢ Curry Mee","å»æ²™ Laksa","ç“¦ç…²äºšå‚é±¼ Assam Fish","æ¸…è’¸é‡‘ç›®é²ˆ Steamed Seabass",
  "ç…²ä»”é¥­ Claypot Rice","å’•å™œè‚‰ Sweet & Sour Pork","é±¼å¤´ç±³ç²‰ Fish Head Bee Hoon","ç‚’ç±³ç²‰ Fried Bee Hoon","ç²¥å“ Congee",
  "çƒ§è…Šé¥­ Roast Meat Rice","è’¸ç‚¹ Dim Sum","é¸¡é¥­ç²’ Chicken Rice Ball","è€é¼ ç²‰ Lou Shu Fan","é…¿è±†è… Yong Tau Foo",
  "æ¿é¢ Pan Mee","ç‚’ç²¿è§’ Char Kuey Kak","å¤è‚‰é¥­ Braised Pork Rice","ä¸œç‚ç‚’é¥­ Tom Yum Fried Rice","å’¸é±¼é¸¡ç²’ç‚’é¥­ Salted Fish Chicken Fried Rice",
  "æ‹›ç‰Œç‚’é¥­ Signature Fried Rice","æ‰¬å·ç‚’é¥­ Yang Zhou Fried Rice","ä¸‰ä¸ç‚’ç±³ç²‰ Fried Vermicelli with Shredded Meat","æœˆå…‰æ²³ Moonlight Hor Fun",
  "æ¸¯å¼äº‘åé¢ HK Wantan Mee","æ¸¯å¼çƒ§é¸­é¥­ Roast Duck Rice","ç™½åˆ‡é¸¡é¥­ Poached Chicken Rice","å®¢å®¶é…¿è±†è… Hakka Yong Tau Foo",
  "å®¢å®¶ç‚¸è‚‰ Hakka Fried Pork","å®¢å®¶çŒªè‚‰ç²‰ Hakka Pork Noodles","æ¢…èœæ‰£è‚‰é¥­ Preserved Veg Pork Rice","è±‰æ±æ’éª¨é¥­ Pork Ribs Rice",
  "è‚‰ç¢é¢ Minced Pork Noodles","å¹²ç‚’ç‰›æ²³ Beef Hor Fun","æ˜Ÿæ´²ç±³ç²‰ Singapore Bee Hoon","XO é…±ç‚’ç±³ç²‰ XO Fried Vermicelli",
  "æµ·é²œç‚’é¢ Seafood Fried Noodles","èšç… Oyster Omelette","èŠ™è“‰è›‹ Fu Yong Egg with Rice","é±¼ç‰‡ç²¥ Fish Porridge","çš®è›‹ç˜¦è‚‰ç²¥ Century Egg Porridge",
  "è‚‰éª¨èŒ¶ Bak Kut Teh","é…±æ²¹é¸¡é¥­ Soy Sauce Chicken Rice","å§œè‘±é±¼ç‰‡é¥­ Ginger Fish Fillet Rice","é»‘èƒ¡æ¤’ç‰›æŸ³é¥­ Black Pepper Beef Rice",
  "ä¸‰æ¯é¸¡é¥­ Three-cup Chicken Rice","å®«ä¿é¸¡ä¸é¥­ Kung Pao Chicken Rice","é±¼é¦™èŒ„å­é¥­ Yu Xiang Eggplant Rice","è±‰æ²¹çš‡ç‚’é¢ Soy Sauce Fried Noodles",
  "é±¼ç‰‡ç±³ç²‰ Fish Fillet Bee Hoon","å•¦å•¦ç‚’ç±³ç²‰ Lala Bee Hoon","å•¦å•¦æ±¤ç±³ç²‰ Lala Soup Bee Hoon","å§œè‘±ç”°é¸¡é¥­ Ginger Frog with Rice",
  "ç”°é¸¡ç²¥ Frog Porridge","æ¸¯å¼çŒªæ‰’é¥­ HK Pork Chop Rice","æ¸¯å¼ç„—é¥­ HK Baked Rice","å’–å–±çŒªæ’é¥­ Curry Pork Chop Rice","éº¦ç‰‡è™¾é¥­ Butter Cereal Prawn Rice",
  "å’¸è›‹è™¾é¥­ Salted Egg Prawn Rice","é“æ¿è±†è…é¥­ Hotplate Tofu with Rice","æ²™ç…²è±†è…é¥­ Claypot Tofu Rice","è’œè“‰èŠ¥å…°é¥­ Garlic Kailan Rice",
  "æ¸…ç‚’è èœé¥­ Stir-fried Spinach with Rice","è’œé¦™æ’éª¨é¥­ Garlic Pork Ribs Rice","æ¤’ç›è‹ä¸œé¥­ Salt & Pepper Squid Rice","å’¸é±¼èŠ±è…©ç…²é¥­ Salted Fish Pork Belly Rice",
  "ç‚’ä¼Šé¢ Fried Yee Mee","åŒæ‹¼çƒ§è…Šé¥­ 2-Combination Roast Meat Rice","ä¸‰æ‹¼çƒ§è…Šé¥­ 3-Combination Roast Meat Rice","æ½®å·ç²¥å¥—é¤ Teochew Porridge Set",
  "æ¸¯å¼å‰çƒ§é¥­ Char Siew Rice","æ¸¯å¼çƒ§è‚‰é¥­ Siew Yoke Rice","æ¸¯å¼çƒ§é¹…é¥­ Roast Goose Rice","è±†é…±è’¸é±¼é¥­ Steamed Fish with Bean Paste Rice",
  "è’œèŒ¸è’¸è™¾é¥­ Steamed Garlic Prawns Rice","æ¢…èœè’¸è‚‰é¥¼é¥­ Steamed Pork Patty with Preserved Veg Rice","é¦™è‡æ»‘é¸¡ç…²é¥­ Claypot Chicken with Mushroom Rice",
  "è±‰æ±è’¸æ’éª¨é¥­ Steamed Pork Ribs with Black Bean Rice","æ¸…è’¸çŸ³æ–‘é¥­ Steamed Grouper Rice",

  // â€”â€” é©¬æ¥ & Mamak æ¡£ (60 é“) â€”â€”
  "æ¤°æµ†é¥­ Nasi Lemak","ä»å½“ç‰›è‚‰ Beef Rendang","é©¬æ¥ç‚’é¢ Mee Goreng Mamak","ç‚’é¥­ Nasi Goreng","æ²™çˆ¹ Satay",
  "äºšå‚å»æ²™ Assam Laksa","ç½—æƒ¹ Rojak","ä¹Œè¾¾ Otak-otak","å‚å³‡é±¿é±¼ Sambal Sotong","å‚å³‡ç©ºå¿ƒèœ Kangkung Belacan",
  "ç”˜æ¦œç‚¸é¸¡ Ayam Goreng Kampung","é©¬æ¥çƒ¤é±¼ Ikan Bakar","é©¬æ¥ç¾Šæ‚ Sup Kambing","é»„å§œé¥­ Nasi Kunyit","å°åº¦ç…é¥¼ Roti Canai",
  "é£é¥¼ Roti Tisu","å°åº¦ç”©é¥¼ Murtabak","æ‰æ‹…é¥­ Nasi Kandar","ç‚­ç‚‰çƒ¤é¸¡ Tandoori Chicken","çƒ¤é¥¼é…å’–å–± Naan Set",
  "é¦™æ–™é¥­ Briyani","Mee Rebus å¤é¢","Mee Jawa çˆªå“‡é¢","Mee Soto å°å°¼é¸¡æ±¤é¢","Lontong ç±³ç³•æ±¤",
  "Soto Ayam é¸¡æ±¤","Ayam Percik çƒ¤é¸¡é¥­","Nasi Goreng Kampung é©¬æ¥é£å‘³ç‚’é¥­","Nasi Goreng Pattaya æ³°å¼ç‚’é¥­åŒ…è›‹","Nasi Goreng USA",
  "Nasi Ayam Penyet å°å°¼æ¶é¸¡é¥­","Nasi Dagang ç™»å˜‰æ¥¼é¥­","Nasi Kerabu è“èŠ±é¥­","Nasi Arab/Bukhari","Maggi Goreng ç‚’Maggi",
  "Maggi Goreng Pattaya","Maggi Sup æ±¤Maggi","Mee Bandung éº»å¡é¢","Laksa Johor æŸ”ä½›å»æ²™","Laksa Kedah å‰æ‰“å»æ²™",
  "Laksa Kelantan å‰å…°ä¸¹å»æ²™","Satay Kajang åŠ å½±æ²™çˆ¹","Ikan Pari Bakar çƒ¤é­”é¬¼é±¼","Sambal Udang å‚å³‡è™¾é¥­","Ayam Masak Merah çº¢é…±é¸¡é¥­",
  "Ayam Kicap é…±æ²¹é¸¡é¥­","Sambal Sotong å‚å³‡é±¿é±¼é¥­","Sup Tulang éª¨æ±¤é¥­","Kari Kepala Ikan å’–å–±é±¼å¤´é¥­","Nasi Tomato ç•ªèŒ„é¥­",
  "Sup Ekor ç‰›å°¾æ±¤é¥­","Mee Kari å’–å–±é¢","Mee Siam æš¹ç½—ç±³ç²‰","Mee Hailam é©¬æ¥ç‚’é¢","Mee Bandung Muar éº»å¡é¢",
  "Mee Goreng Basah æ¹¿ç‚’é¢","Maggi Kari å’–å–±Maggi","Murtabak Ayam é¸¡è‚‰é¦…é¥¼","Murtabak Daging ç‰›è‚‰é¦…é¥¼","Roti Telur é¸¡è›‹é¥¼",
  "Roti Planta ç‰›æ²¹é¥¼","Roti Sardin æ²™ä¸é±¼é¥¼",

  // â€”â€” æ³°é¤ (30 é“) â€”â€”
  "Pad Thai æ³°å¼ç‚’ç²‰","Tom Yum Fried Rice ä¸œç‚ç‚’é¥­","Thai Basil Chicken Rice æ‰“æŠ›é¸¡é¥­","Thai Pork Leg Rice çŒªè„šé¥­","Thai Green Curry with Rice ç»¿å’–å–±é¥­",
  "Thai Red Curry with Rice çº¢å’–å–±é¥­","Thai Yellow Curry with Rice é»„å’–å–±é¥­","Som Tam æœ¨ç“œæ²™æ‹‰","Thai Fried Chicken æ³°å¼ç‚¸é¸¡","Thai Pineapple Fried Rice è èç‚’é¥­",
  "Thai Crab Fried Rice èƒèŸ¹ç‚’é¥­","Thai Shrimp Fried Rice è™¾ç‚’é¥­","Thai Glass Noodle Salad å†¬ç²‰æ²™æ‹‰","Thai Tom Yum Noodles ä¸œç‚æ±¤é¢","Thai Boat Noodles æ²³ç²‰",
  "Thai Pad Kee Mao é†‰é¬¼ç‚’ç²‰","Thai Basil Pork Rice æ‰“æŠ›çŒªé¥­","Thai Omelette Rice æ³°å¼è›‹åŒ…é¥­","Thai Chicken Rice æ³°å¼é¸¡é¥­","Thai BBQ Pork Rice çƒ¤çŒªé¢ˆè‚‰é¥­",
  "Thai Duck Noodles é¸­è‚‰æ²³ç²‰","Thai Beef Noodles ç‰›è‚‰æ²³ç²‰","Thai Fish Tom Yum Noodles é±¼ä¸œç‚ç±³ç²‰","Thai Crab Omelette èŸ¹è‚‰ç…è›‹é¥­","Thai Seafood Pad Thai æµ·é²œç‚’ç²‰",
  "Thai Minced Pork Noodles çŒªè‚‰ç±³ç²‰","Thai Hotpot with Rice æ³°å¼ç«é”…é¥­","Thai Steamed Fish Rice æ¸…è’¸é±¼é¥­","Thai Fried Squid Rice ç‚¸é±¿é±¼é¥­","Thai Curry Fried Noodles å’–å–±ç‚’ç²‰",

  // â€”â€” éŸ©é¤ (30 é“) â€”â€”
  "Bibimbap çŸ³é”…æ‹Œé¥­","Kimchi Fried Rice æ³¡èœç‚’é¥­","Army Stew éƒ¨é˜Ÿé”…","Samgyeopsal with Rice éŸ©å¼çƒ¤äº”èŠ±é¥­","Bulgogi Beef Rice éŸ©å¼çƒ¤ç‰›è‚‰é¥­",
  "Dak Galbi è¾£ç‚’é¸¡æ’é¥­","Samgyetang äººå‚é¸¡æ±¤","Naengmyeon å†·é¢","Bibim Naengmyeon æ‹Œå†·é¢","Haemul Pajeon æµ·é²œç…é¥¼",
  "Kimchi Jjigae æ³¡èœæ±¤é¥­","Doenjang Jjigae å¤§é…±æ±¤é¥­","Sundubu Jjigae å«©è±†è…æ±¤é¥­","Gimbap ç´«èœåŒ…é¥­","Tteokbokki è¾£ç‚’å¹´ç³•",
  "Korean Fried Chicken éŸ©å¼ç‚¸é¸¡","Galbitang ç‰›éª¨æ±¤é¥­","Seolleongtang ç‰›éª¨ç™½æ±¤é¥­","Ojingeo Bokkeum è¾£ç‚’é±¿é±¼é¥­","Jjajangmyeon ç‚¸é…±é¢",
  "Jjamppong æµ·é²œè¾£æ±¤é¢","Korean Pork Cutlet éŸ©å¼ç‚¸çŒªæ’","Korean Hotpot with Rice éŸ©å¼ç«é”…é¥­","Korean Cold Noodles éŸ©å¼å†·é¢","Bossam éŸ©å¼è’¸äº”èŠ±è‚‰é¥­",
  "Samgyupsal Bibimbap äº”èŠ±æ‹Œé¥­","Korean Chicken Mayo Rice é¸¡è‚‰è›‹é»„é…±é¥­","Korean Curry Rice éŸ©å¼å’–å–±é¥­","Spicy Ramen éŸ©å¼è¾£æ‹‰é¢","Cheese Ramen èŠå£«æ‹‰é¢",

  // â€”â€” æ—¥é¤ (50 é“) â€”â€”
  "Ramen æ‹‰é¢","Udon ä¹Œå†¬é¢","Soba èéº¦é¢","Japanese Curry Rice æ—¥å¼å’–å–±é¥­","Unagi Don é³—é±¼é¥­",
  "Oyakodon äº²å­ä¸¼","Gyudon ç‰›ä¸¼","Tendon å¤©å¦‡ç½—ç›–é¥­","Chirashi Don åˆºèº«ä¸¼","Katsudon ç‚¸çŒªæ’é¥­",
  "Yakitori Don çƒ¤é¸¡ä¸²ç›–é¥­","Chashu Ramen å‰çƒ§æ‹‰é¢","Miso Ramen å‘³å™Œæ‹‰é¢","Shoyu Ramen é…±æ²¹æ‹‰é¢","Shio Ramen ç›å‘³æ‹‰é¢",
  "Tonkotsu Ramen è±šéª¨æ‹‰é¢","Hiyashi Chuka å†·ä¸­åé¢","Hiyashi Soba å†·èéº¦é¢","Tsukemen æ²¾é¢","Seafood Ramen æµ·é²œæ‹‰é¢",
  "Curry Udon å’–å–±ä¹Œå†¬","Tempura Udon å¤©å¦‡ç½—ä¹Œå†¬","Zaru Soba å†·èéº¦é¢","Nabeyaki Udon é”…çƒ§ä¹Œå†¬","Omu Rice è›‹åŒ…é¥­",
  "Hambagu æ±‰å ¡æ’é¥­","Mentaiko Pasta æ˜å¤ªå­æ„é¢","Okonomiyaki å¤§é˜ªçƒ§","Takoyaki ç« é±¼çƒ§","Yakisoba æ—¥å¼ç‚’é¢",
  "Japanese Fried Rice æ—¥å¼ç‚’é¥­","Hokkaido Soup Curry åŒ—æµ·é“å’–å–±é¥­","Hokkaido Butter Corn Ramen åŒ—æµ·é“ç‰ç±³æ‹‰é¢","Chicken Katsu Curry é¸¡æ’å’–å–±é¥­","Pork Katsu Curry çŒªæ’å’–å–±é¥­",
  "Torikatsu Don ç‚¸é¸¡æ’ç›–é¥­","Gyu Katsu Don ç‚¸ç‰›æ’ç›–é¥­","Ebi Fry Curry ç‚¸è™¾å’–å–±é¥­","Ebi Tempura Don ç‚¸è™¾ç›–é¥­","Chicken Karaage Don ç‚¸é¸¡å—ç›–é¥­",
  "Japanese Hotpot with Rice æ—¥å¼ç«é”…é¥­","Salmon Don ä¸‰æ–‡é±¼ç›–é¥­","Ikura Don ä¸‰æ–‡é±¼ç±½ç›–é¥­","Tonkatsu Bento ç‚¸çŒªæ’ä¾¿å½“","Saba Shioyaki Bento çƒ¤é²­é±¼ä¾¿å½“",
  "Teriyaki Chicken Don ç…§çƒ§é¸¡ç›–é¥­","Butadon çƒ¤çŒªè‚‰ç›–é¥­","Gindara Saikyo Yaki é“¶é³•é±¼é¥­","Japanese Hamburg Bento æ±‰å ¡æ’ä¾¿å½“","Tamago Don ç‰å­ä¸¼",

  // â€”â€” è¥¿å¼ä¸»é£Ÿ (50 é“) â€”â€”
  "Pizza æŠ«è¨","Burger æ±‰å ¡","Hotdog çƒ­ç‹—","Fish & Chips ç‚¸é±¼è–¯æ¡","Carbonara å¥¶æ²¹åŸ¹æ ¹æ„é¢",
  "Spaghetti Bolognese è‚‰é…±æ„é¢","Lasagna åƒå±‚é¢","Mac & Cheese èŠå£«é€šå¿ƒç²‰","BBQ Ribs çƒ¤æ’éª¨","Steak ç‰›æ’",
  "Lamb Chop ç¾Šæ’","Roast Chicken çƒ¤é¸¡","Grilled Salmon çƒ¤ä¸‰æ–‡é±¼","Fried Chicken ç‚¸é¸¡å¥—é¤","Chicken Chop é¸¡æ’é¥­",
  "Pork Chop çŒªæ’é¥­","Beef Steak with Fries ç‰›æ’è–¯æ¡","Grilled Lamb Rack çƒ¤ç¾Šæ¶","Steak Frites æ³•å¼ç‰›æ’è–¯æ¡","Escargot æ³•å¼èœ—ç‰›",
  "Burrito å¢¨è¥¿å“¥å·é¥¼","Taco å¡”å¯","Nachos ç‰ç±³ç‰‡","Quesadilla å¢¨è¥¿å“¥çƒ¤é¥¼","Chili Con Carne ç‰›è‚‰è¾£è±†é¥­",
  "Shepherdâ€™s Pie ç‰§ç¾Šäººæ´¾","Cottage Pie ç‰›è‚‰æ´¾","Roast Pork Belly çƒ¤äº”èŠ±è‚‰","Roast Duck Breast çƒ¤é¸­èƒ¸","Grilled Sausage é¦™è‚ é¥­",
  "Garlic Bread è’œé¦™é¢åŒ…","Caesar Salad å‡¯æ’’æ²™æ‹‰","Mushroom Soup è˜‘è‡æ±¤","Onion Soup æ´‹è‘±æ±¤","Chicken Wrap é¸¡è‚‰å·",
  "Beef Wrap ç‰›è‚‰å·","Corn Dog çƒ­ç‹—èŠå£«å·","Fried Calamari ç‚¸é±¿é±¼åœˆ","Baked Potato çƒ¤é©¬é“ƒè–¯","Onion Rings ç‚¸æ´‹è‘±åœˆ",
  "Cheese Burger èŠå£«æ±‰å ¡","Double Patty Burger åŒå±‚ç‰›è‚‰æ±‰å ¡","Chicken Pizza é¸¡è‚‰æŠ«è¨","Seafood Pizza æµ·é²œæŠ«è¨","Pepperoni Pizza æ„å¤§åˆ©è¾£é¦™è‚ æŠ«è¨",
  "Hawaiian Pizza å¤å¨å¤·æŠ«è¨","Margarita Pizza ç›æ ¼ä¸½å¡”æŠ«è¨","Chicken Lasagna é¸¡è‚‰åƒå±‚é¢","Beef Lasagna ç‰›è‚‰åƒå±‚é¢","Seafood Spaghetti æµ·é²œæ„é¢"
];
  const wheel = document.getElementById('wheel');
  const ctx = wheel.getContext('2d');
  const itemList = document.getElementById('itemList');
  const resultDom = document.getElementById('result');
  const spinBtn = document.getElementById('spinBtn');
  const refreshBtn = document.getElementById('refreshBtn');
  const confetti = document.getElementById('confetti');
  const cctx = confetti.getContext('2d');

  let pool = [...defaultPool];
  let items = pickRandom10(pool);
  let angle = 0; let spinning = false; let startAngle=0, targetAngle=0, startTime=0, duration=0;
  let lastTick = -1; let audioCtx = null; let confs = [];

  function pickRandom10(pool){ const arr=[...pool]; for(let i=arr.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr.slice(0,10);} 

  function getIndex(){
    const n = items.length; const slice = Math.PI*2/n;
    const pointerAngle = -Math.PI/2; // 12ç‚¹æœä¸‹
    let rel = (pointerAngle - angle) % (Math.PI*2);
    if (rel < 0) rel += Math.PI*2;
    return Math.floor(rel / slice) % n;
  }

  function easeOutCubic(t){ return 1-Math.pow(1-t,3); }
  function playTick(){ try{ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); if(audioCtx.state==='suspended') audioCtx.resume(); const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type='square'; o.frequency.value=1000; g.gain.value=0.02; o.connect(g).connect(audioCtx.destination); o.start(); setTimeout(()=>o.stop(),40);}catch(e){} }

  function drawWheel(){
    const W=wheel.width, H=wheel.height; const cx=W/2, cy=H/2, r=Math.min(W,H)/2-12; ctx.clearRect(0,0,W,H);
    const n=items.length; const slice=Math.PI*2/Math.max(n,1);
    for(let i=0;i<n;i++){
      const start=angle+i*slice, end=start+slice, mid=(start+end)/2; const hue=(i*360/n)|0; 
      const c1=`hsl(${hue} 80% 65%)`, c2=`hsl(${(hue+24)%360} 80% 55%)`; 
      const grad=ctx.createLinearGradient(cx+Math.cos(start)*r, cy+Math.sin(start)*r, cx, cy); grad.addColorStop(0,c1); grad.addColorStop(1,c2);
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,r,start,end); ctx.closePath(); ctx.fillStyle=grad; ctx.fill(); ctx.strokeStyle='rgba(255,255,255,.5)'; ctx.lineWidth=1.2; ctx.stroke();
      ctx.save(); ctx.translate(cx+Math.cos(mid)*(r*0.72), cy+Math.sin(mid)*(r*0.72)); ctx.rotate(mid+Math.PI/2); ctx.fillStyle='#fff'; ctx.font='700 15px system-ui'; const label=items[i]; const txt=label.length>8?label.slice(0,8)+'â€¦':label; ctx.textAlign='center'; ctx.fillText(txt,0,5); ctx.restore();
    }
    ctx.beginPath(); ctx.arc(cx,cy,58,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill(); ctx.strokeStyle='#e5e7eb'; ctx.lineWidth=3; ctx.stroke(); ctx.fillStyle='#111827'; ctx.font='700 16px system-ui'; ctx.textAlign='center'; ctx.fillText('ä»Šå¤©',cx,cy-4); ctx.fillStyle='#ef4444'; ctx.font='900 20px system-ui'; ctx.fillText('åƒå•¥',cx,cy+20);
  }

  function renderList(){ itemList.innerHTML=''; items.forEach(it=>{ const d=document.createElement('div'); d.className='tag'; d.textContent=it; itemList.appendChild(d); }); }

  function animate(){ if(!spinning) return; const t=Math.min((performance.now()-startTime)/duration,1); angle = startAngle + (targetAngle-startAngle)*easeOutCubic(t); const idx=getIndex(); if(idx!==lastTick){ lastTick=idx; playTick(); } drawWheel(); if(t<1){ requestAnimationFrame(animate); } else { spinning=false; finishSpin(); } }
  function spin(){ if(spinning||items.length===0) return; spinning=true; lastTick=-1; const extra=6+Math.random()*3; startAngle=angle; targetAngle=angle+extra*Math.PI*2+Math.random()*Math.PI*2; duration=2600+Math.random()*800; startTime=performance.now(); requestAnimationFrame(animate); }
  function finishSpin(){ const {label}=getResult(); resultDom.innerHTML = `ğŸ¯ å‘½è¿å®‰æ’ï¼š<b style=\"font-size:28px\">${label}</b>ï¼`; boomConfetti(); }
  function getResult(){ return { index:getIndex(), label: items[getIndex()] }; }

  function boomConfetti(){
    confetti.width = innerWidth; confetti.height = innerHeight;
    confs = new Array(160).fill(0).map(()=>({
      x: innerWidth/2 + (Math.random()-0.5)*200,
      y: innerHeight/3 + (Math.random()-0.5)*120,
      r: 2 + Math.random()*3,
      vx: (Math.random()-0.5)*6,
      vy: -Math.random()*7,
      g: 0.18 + Math.random()*0.22,
      life: 60 + (Math.random()*60|0),
      color: `hsl(${(Math.random()*360)|0} 80% 60%)`
    }));
    drawConfetti();
  }
  function drawConfetti(){
    cctx.clearRect(0,0,confetti.width,confetti.height);
    confs.forEach(p=>{ cctx.beginPath(); cctx.arc(p.x,p.y,p.r,0,Math.PI*2); cctx.fillStyle=p.color; cctx.fill(); p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.life--; });
    confs = confs.filter(p=> p.y < confetti.height+10 && p.life>0 );
    if(confs.length) requestAnimationFrame(drawConfetti);
  }
  addEventListener('resize',()=>{ confetti.width=innerWidth; confetti.height=innerHeight; });

  spinBtn.addEventListener('click', spin);
  refreshBtn.addEventListener('click', ()=>{ items=pickRandom10(pool); drawWheel(); renderList(); resultDom.textContent='å·²æ¢ä¸€æ‰¹ï¼ç‚¹å¼€å§‹è½¬ï½'; });

  drawWheel(); renderList();
</script>
</body>
</html>
