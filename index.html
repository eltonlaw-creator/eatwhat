<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>今天吃啥</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Microsoft Yahei",sans-serif; background:#fff7ee; margin:0; color:#0f172a; }
    .stage { width:min(560px,92vw); margin:28px auto 10px; position:relative; }
    canvas#wheel { width:100%; aspect-ratio:1/1; background:#fff; border-radius:50%; border:8px solid #e5e7eb; display:block; }
    /* 指针在12点方向，尖端朝下 */
    .pointer { position:absolute; top:-28px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:18px solid transparent; border-right:18px solid transparent; border-top:32px solid #ef4444; }
    .controls { text-align:center; margin-top: 12px; }
    button { margin: 6px; padding: 10px 18px; font-size: 16px; border:0; border-radius:10px; cursor:pointer; color:#fff; background:linear-gradient(135deg,#ffa7c8,#ff8fab); box-shadow:0 6px 16px rgba(255,143,171,.35);} 
    button.alt{ background:linear-gradient(135deg,#93c5fd,#a7f3d0);} 
    #result { text-align:center; font-size:32px; font-weight:900; margin-top:12px; color:#111827; }
    #itemList { display:flex; flex-wrap:wrap; gap:6px; margin:16px auto; width:min(560px,92vw); justify-content:center; }
    .tag { background:#f8fafc; padding:6px 10px; border-radius:8px; border:1px solid #e2e8f0; }
    footer { text-align:center; margin:16px; color:#334155; font-size:12px; }
    #confetti { position:fixed; inset:0; pointer-events:none; }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="stage">
    <i class="pointer"></i>
    <canvas id="wheel" width="700" height="700"></canvas>
  </div>
  <div class="controls">
    <button id="spinBtn">开始转！</button>
    <button id="refreshBtn" class="alt">换一批(10)</button>
  </div>
  <div id="result">点击开始转！</div>
  <div class="hint" style="text-align:center;color:#64748b;font-size:13px">点击“换一批(10)”可重抽。</div>
  <div id="itemList"></div>
  <footer>Created by Elton</footer>

<script>
const defaultPool = [
  // —— 华人小贩/煮炒 (80 道) ——
  "炒粿条 Char Kway Teow","福建面 Hokkien Mee","云吞面 Wantan Mee","干捞面 Dry Noodles","砂煲鸡饭 Claypot Chicken Rice",
  "海南鸡饭 Hainanese Chicken Rice","咖喱面 Curry Mee","叻沙 Laksa","瓦煲亚参鱼 Assam Fish","清蒸金目鲈 Steamed Seabass",
  "煲仔饭 Claypot Rice","咕噜肉 Sweet & Sour Pork","鱼头米粉 Fish Head Bee Hoon","炒米粉 Fried Bee Hoon","粥品 Congee",
  "烧腊饭 Roast Meat Rice","蒸点 Dim Sum","鸡饭粒 Chicken Rice Ball","老鼠粉 Lou Shu Fan","酿豆腐 Yong Tau Foo",
  "板面 Pan Mee","炒粿角 Char Kuey Kak","卤肉饭 Braised Pork Rice","东炎炒饭 Tom Yum Fried Rice","咸鱼鸡粒炒饭 Salted Fish Chicken Fried Rice",
  "招牌炒饭 Signature Fried Rice","扬州炒饭 Yang Zhou Fried Rice","三丝炒米粉 Fried Vermicelli with Shredded Meat","月光河 Moonlight Hor Fun",
  "港式云吞面 HK Wantan Mee","港式烧鸭饭 Roast Duck Rice","白切鸡饭 Poached Chicken Rice","客家酿豆腐 Hakka Yong Tau Foo",
  "客家炸肉 Hakka Fried Pork","客家猪肉粉 Hakka Pork Noodles","梅菜扣肉饭 Preserved Veg Pork Rice","豉汁排骨饭 Pork Ribs Rice",
  "肉碎面 Minced Pork Noodles","干炒牛河 Beef Hor Fun","星洲米粉 Singapore Bee Hoon","XO 酱炒米粉 XO Fried Vermicelli",
  "海鲜炒面 Seafood Fried Noodles","蚝煎 Oyster Omelette","芙蓉蛋 Fu Yong Egg with Rice","鱼片粥 Fish Porridge","皮蛋瘦肉粥 Century Egg Porridge",
  "肉骨茶 Bak Kut Teh","酱油鸡饭 Soy Sauce Chicken Rice","姜葱鱼片饭 Ginger Fish Fillet Rice","黑胡椒牛柳饭 Black Pepper Beef Rice",
  "三杯鸡饭 Three-cup Chicken Rice","宫保鸡丁饭 Kung Pao Chicken Rice","鱼香茄子饭 Yu Xiang Eggplant Rice","豉油皇炒面 Soy Sauce Fried Noodles",
  "鱼片米粉 Fish Fillet Bee Hoon","啦啦炒米粉 Lala Bee Hoon","啦啦汤米粉 Lala Soup Bee Hoon","姜葱田鸡饭 Ginger Frog with Rice",
  "田鸡粥 Frog Porridge","港式猪扒饭 HK Pork Chop Rice","港式焗饭 HK Baked Rice","咖喱猪排饭 Curry Pork Chop Rice","麦片虾饭 Butter Cereal Prawn Rice",
  "咸蛋虾饭 Salted Egg Prawn Rice","铁板豆腐饭 Hotplate Tofu with Rice","沙煲豆腐饭 Claypot Tofu Rice","蒜蓉芥兰饭 Garlic Kailan Rice",
  "清炒菠菜饭 Stir-fried Spinach with Rice","蒜香排骨饭 Garlic Pork Ribs Rice","椒盐苏东饭 Salt & Pepper Squid Rice","咸鱼花腩煲饭 Salted Fish Pork Belly Rice",
  "炒伊面 Fried Yee Mee","双拼烧腊饭 2-Combination Roast Meat Rice","三拼烧腊饭 3-Combination Roast Meat Rice","潮州粥套餐 Teochew Porridge Set",
  "港式叉烧饭 Char Siew Rice","港式烧肉饭 Siew Yoke Rice","港式烧鹅饭 Roast Goose Rice","豆酱蒸鱼饭 Steamed Fish with Bean Paste Rice",
  "蒜茸蒸虾饭 Steamed Garlic Prawns Rice","梅菜蒸肉饼饭 Steamed Pork Patty with Preserved Veg Rice","香菇滑鸡煲饭 Claypot Chicken with Mushroom Rice",
  "豉汁蒸排骨饭 Steamed Pork Ribs with Black Bean Rice","清蒸石斑饭 Steamed Grouper Rice",

  // —— 马来 & Mamak 档 (60 道) ——
  "椰浆饭 Nasi Lemak","仁当牛肉 Beef Rendang","马来炒面 Mee Goreng Mamak","炒饭 Nasi Goreng","沙爹 Satay",
  "亚参叻沙 Assam Laksa","罗惹 Rojak","乌达 Otak-otak","参峇鱿鱼 Sambal Sotong","参峇空心菜 Kangkung Belacan",
  "甘榜炸鸡 Ayam Goreng Kampung","马来烤鱼 Ikan Bakar","马来羊杂 Sup Kambing","黄姜饭 Nasi Kunyit","印度煎饼 Roti Canai",
  "飞饼 Roti Tisu","印度甩饼 Murtabak","扁担饭 Nasi Kandar","炭炉烤鸡 Tandoori Chicken","烤饼配咖喱 Naan Set",
  "香料饭 Briyani","Mee Rebus 卤面","Mee Jawa 爪哇面","Mee Soto 印尼鸡汤面","Lontong 米糕汤",
  "Soto Ayam 鸡汤","Ayam Percik 烤鸡饭","Nasi Goreng Kampung 马来风味炒饭","Nasi Goreng Pattaya 泰式炒饭包蛋","Nasi Goreng USA",
  "Nasi Ayam Penyet 印尼捶鸡饭","Nasi Dagang 登嘉楼饭","Nasi Kerabu 蓝花饭","Nasi Arab/Bukhari","Maggi Goreng 炒Maggi",
  "Maggi Goreng Pattaya","Maggi Sup 汤Maggi","Mee Bandung 麻坡面","Laksa Johor 柔佛叻沙","Laksa Kedah 吉打叻沙",
  "Laksa Kelantan 吉兰丹叻沙","Satay Kajang 加影沙爹","Ikan Pari Bakar 烤魔鬼鱼","Sambal Udang 参峇虾饭","Ayam Masak Merah 红酱鸡饭",
  "Ayam Kicap 酱油鸡饭","Sambal Sotong 参峇鱿鱼饭","Sup Tulang 骨汤饭","Kari Kepala Ikan 咖喱鱼头饭","Nasi Tomato 番茄饭",
  "Sup Ekor 牛尾汤饭","Mee Kari 咖喱面","Mee Siam 暹罗米粉","Mee Hailam 马来炒面","Mee Bandung Muar 麻坡面",
  "Mee Goreng Basah 湿炒面","Maggi Kari 咖喱Maggi","Murtabak Ayam 鸡肉馅饼","Murtabak Daging 牛肉馅饼","Roti Telur 鸡蛋饼",
  "Roti Planta 牛油饼","Roti Sardin 沙丁鱼饼",

  // —— 泰餐 (30 道) ——
  "Pad Thai 泰式炒粉","Tom Yum Fried Rice 东炎炒饭","Thai Basil Chicken Rice 打抛鸡饭","Thai Pork Leg Rice 猪脚饭","Thai Green Curry with Rice 绿咖喱饭",
  "Thai Red Curry with Rice 红咖喱饭","Thai Yellow Curry with Rice 黄咖喱饭","Som Tam 木瓜沙拉","Thai Fried Chicken 泰式炸鸡","Thai Pineapple Fried Rice 菠萝炒饭",
  "Thai Crab Fried Rice 螃蟹炒饭","Thai Shrimp Fried Rice 虾炒饭","Thai Glass Noodle Salad 冬粉沙拉","Thai Tom Yum Noodles 东炎汤面","Thai Boat Noodles 河粉",
  "Thai Pad Kee Mao 醉鬼炒粉","Thai Basil Pork Rice 打抛猪饭","Thai Omelette Rice 泰式蛋包饭","Thai Chicken Rice 泰式鸡饭","Thai BBQ Pork Rice 烤猪颈肉饭",
  "Thai Duck Noodles 鸭肉河粉","Thai Beef Noodles 牛肉河粉","Thai Fish Tom Yum Noodles 鱼东炎米粉","Thai Crab Omelette 蟹肉煎蛋饭","Thai Seafood Pad Thai 海鲜炒粉",
  "Thai Minced Pork Noodles 猪肉米粉","Thai Hotpot with Rice 泰式火锅饭","Thai Steamed Fish Rice 清蒸鱼饭","Thai Fried Squid Rice 炸鱿鱼饭","Thai Curry Fried Noodles 咖喱炒粉",

  // —— 韩餐 (30 道) ——
  "Bibimbap 石锅拌饭","Kimchi Fried Rice 泡菜炒饭","Army Stew 部队锅","Samgyeopsal with Rice 韩式烤五花饭","Bulgogi Beef Rice 韩式烤牛肉饭",
  "Dak Galbi 辣炒鸡排饭","Samgyetang 人参鸡汤","Naengmyeon 冷面","Bibim Naengmyeon 拌冷面","Haemul Pajeon 海鲜煎饼",
  "Kimchi Jjigae 泡菜汤饭","Doenjang Jjigae 大酱汤饭","Sundubu Jjigae 嫩豆腐汤饭","Gimbap 紫菜包饭","Tteokbokki 辣炒年糕",
  "Korean Fried Chicken 韩式炸鸡","Galbitang 牛骨汤饭","Seolleongtang 牛骨白汤饭","Ojingeo Bokkeum 辣炒鱿鱼饭","Jjajangmyeon 炸酱面",
  "Jjamppong 海鲜辣汤面","Korean Pork Cutlet 韩式炸猪排","Korean Hotpot with Rice 韩式火锅饭","Korean Cold Noodles 韩式冷面","Bossam 韩式蒸五花肉饭",
  "Samgyupsal Bibimbap 五花拌饭","Korean Chicken Mayo Rice 鸡肉蛋黄酱饭","Korean Curry Rice 韩式咖喱饭","Spicy Ramen 韩式辣拉面","Cheese Ramen 芝士拉面",

  // —— 日餐 (50 道) ——
  "Ramen 拉面","Udon 乌冬面","Soba 荞麦面","Japanese Curry Rice 日式咖喱饭","Unagi Don 鳗鱼饭",
  "Oyakodon 亲子丼","Gyudon 牛丼","Tendon 天妇罗盖饭","Chirashi Don 刺身丼","Katsudon 炸猪排饭",
  "Yakitori Don 烤鸡串盖饭","Chashu Ramen 叉烧拉面","Miso Ramen 味噌拉面","Shoyu Ramen 酱油拉面","Shio Ramen 盐味拉面",
  "Tonkotsu Ramen 豚骨拉面","Hiyashi Chuka 冷中华面","Hiyashi Soba 冷荞麦面","Tsukemen 沾面","Seafood Ramen 海鲜拉面",
  "Curry Udon 咖喱乌冬","Tempura Udon 天妇罗乌冬","Zaru Soba 冷荞麦面","Nabeyaki Udon 锅烧乌冬","Omu Rice 蛋包饭",
  "Hambagu 汉堡排饭","Mentaiko Pasta 明太子意面","Okonomiyaki 大阪烧","Takoyaki 章鱼烧","Yakisoba 日式炒面",
  "Japanese Fried Rice 日式炒饭","Hokkaido Soup Curry 北海道咖喱饭","Hokkaido Butter Corn Ramen 北海道玉米拉面","Chicken Katsu Curry 鸡排咖喱饭","Pork Katsu Curry 猪排咖喱饭",
  "Torikatsu Don 炸鸡排盖饭","Gyu Katsu Don 炸牛排盖饭","Ebi Fry Curry 炸虾咖喱饭","Ebi Tempura Don 炸虾盖饭","Chicken Karaage Don 炸鸡块盖饭",
  "Japanese Hotpot with Rice 日式火锅饭","Salmon Don 三文鱼盖饭","Ikura Don 三文鱼籽盖饭","Tonkatsu Bento 炸猪排便当","Saba Shioyaki Bento 烤鲭鱼便当",
  "Teriyaki Chicken Don 照烧鸡盖饭","Butadon 烤猪肉盖饭","Gindara Saikyo Yaki 银鳕鱼饭","Japanese Hamburg Bento 汉堡排便当","Tamago Don 玉子丼",

  // —— 西式主食 (50 道) ——
  "Pizza 披萨","Burger 汉堡","Hotdog 热狗","Fish & Chips 炸鱼薯条","Carbonara 奶油培根意面",
  "Spaghetti Bolognese 肉酱意面","Lasagna 千层面","Mac & Cheese 芝士通心粉","BBQ Ribs 烤排骨","Steak 牛排",
  "Lamb Chop 羊排","Roast Chicken 烤鸡","Grilled Salmon 烤三文鱼","Fried Chicken 炸鸡套餐","Chicken Chop 鸡排饭",
  "Pork Chop 猪排饭","Beef Steak with Fries 牛排薯条","Grilled Lamb Rack 烤羊架","Steak Frites 法式牛排薯条","Escargot 法式蜗牛",
  "Burrito 墨西哥卷饼","Taco 塔可","Nachos 玉米片","Quesadilla 墨西哥烤饼","Chili Con Carne 牛肉辣豆饭",
  "Shepherd’s Pie 牧羊人派","Cottage Pie 牛肉派","Roast Pork Belly 烤五花肉","Roast Duck Breast 烤鸭胸","Grilled Sausage 香肠饭",
  "Garlic Bread 蒜香面包","Caesar Salad 凯撒沙拉","Mushroom Soup 蘑菇汤","Onion Soup 洋葱汤","Chicken Wrap 鸡肉卷",
  "Beef Wrap 牛肉卷","Corn Dog 热狗芝士卷","Fried Calamari 炸鱿鱼圈","Baked Potato 烤马铃薯","Onion Rings 炸洋葱圈",
  "Cheese Burger 芝士汉堡","Double Patty Burger 双层牛肉汉堡","Chicken Pizza 鸡肉披萨","Seafood Pizza 海鲜披萨","Pepperoni Pizza 意大利辣香肠披萨",
  "Hawaiian Pizza 夏威夷披萨","Margarita Pizza 玛格丽塔披萨","Chicken Lasagna 鸡肉千层面","Beef Lasagna 牛肉千层面","Seafood Spaghetti 海鲜意面"
];
  const wheel = document.getElementById('wheel');
  const ctx = wheel.getContext('2d');
  const itemList = document.getElementById('itemList');
  const resultDom = document.getElementById('result');
  const spinBtn = document.getElementById('spinBtn');
  const refreshBtn = document.getElementById('refreshBtn');
  const confetti = document.getElementById('confetti');
  const cctx = confetti.getContext('2d');

  let pool = [...defaultPool];
  let items = pickRandom10(pool);
  let angle = 0; let spinning = false; let startAngle=0, targetAngle=0, startTime=0, duration=0;
  let lastTick = -1; let audioCtx = null; let confs = [];

  function pickRandom10(pool){ const arr=[...pool]; for(let i=arr.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr.slice(0,10);} 

  function getIndex(){
    const n = items.length; const slice = Math.PI*2/n;
    const pointerAngle = -Math.PI/2; // 12点朝下
    let rel = (pointerAngle - angle) % (Math.PI*2);
    if (rel < 0) rel += Math.PI*2;
    return Math.floor(rel / slice) % n;
  }

  function easeOutCubic(t){ return 1-Math.pow(1-t,3); }
  function playTick(){ try{ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); if(audioCtx.state==='suspended') audioCtx.resume(); const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type='square'; o.frequency.value=1000; g.gain.value=0.02; o.connect(g).connect(audioCtx.destination); o.start(); setTimeout(()=>o.stop(),40);}catch(e){} }

  function drawWheel(){
    const W=wheel.width, H=wheel.height; const cx=W/2, cy=H/2, r=Math.min(W,H)/2-12; ctx.clearRect(0,0,W,H);
    const n=items.length; const slice=Math.PI*2/Math.max(n,1);
    for(let i=0;i<n;i++){
      const start=angle+i*slice, end=start+slice, mid=(start+end)/2; const hue=(i*360/n)|0; 
      const c1=`hsl(${hue} 80% 65%)`, c2=`hsl(${(hue+24)%360} 80% 55%)`; 
      const grad=ctx.createLinearGradient(cx+Math.cos(start)*r, cy+Math.sin(start)*r, cx, cy); grad.addColorStop(0,c1); grad.addColorStop(1,c2);
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,r,start,end); ctx.closePath(); ctx.fillStyle=grad; ctx.fill(); ctx.strokeStyle='rgba(255,255,255,.5)'; ctx.lineWidth=1.2; ctx.stroke();
      ctx.save(); ctx.translate(cx+Math.cos(mid)*(r*0.72), cy+Math.sin(mid)*(r*0.72)); ctx.rotate(mid+Math.PI/2); ctx.fillStyle='#fff'; ctx.font='700 15px system-ui'; const label=items[i]; const txt=label.length>8?label.slice(0,8)+'…':label; ctx.textAlign='center'; ctx.fillText(txt,0,5); ctx.restore();
    }
    ctx.beginPath(); ctx.arc(cx,cy,58,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill(); ctx.strokeStyle='#e5e7eb'; ctx.lineWidth=3; ctx.stroke(); ctx.fillStyle='#111827'; ctx.font='700 16px system-ui'; ctx.textAlign='center'; ctx.fillText('今天',cx,cy-4); ctx.fillStyle='#ef4444'; ctx.font='900 20px system-ui'; ctx.fillText('吃啥',cx,cy+20);
  }

  function renderList(){ itemList.innerHTML=''; items.forEach(it=>{ const d=document.createElement('div'); d.className='tag'; d.textContent=it; itemList.appendChild(d); }); }

  function animate(){ if(!spinning) return; const t=Math.min((performance.now()-startTime)/duration,1); angle = startAngle + (targetAngle-startAngle)*easeOutCubic(t); const idx=getIndex(); if(idx!==lastTick){ lastTick=idx; playTick(); } drawWheel(); if(t<1){ requestAnimationFrame(animate); } else { spinning=false; finishSpin(); } }
  function spin(){ if(spinning||items.length===0) return; spinning=true; lastTick=-1; const extra=6+Math.random()*3; startAngle=angle; targetAngle=angle+extra*Math.PI*2+Math.random()*Math.PI*2; duration=2600+Math.random()*800; startTime=performance.now(); requestAnimationFrame(animate); }
  function finishSpin(){ const {label}=getResult(); resultDom.innerHTML = `🎯 命运安排：<b style=\"font-size:28px\">${label}</b>！`; boomConfetti(); }
  function getResult(){ return { index:getIndex(), label: items[getIndex()] }; }

  function boomConfetti(){
    confetti.width = innerWidth; confetti.height = innerHeight;
    confs = new Array(160).fill(0).map(()=>({
      x: innerWidth/2 + (Math.random()-0.5)*200,
      y: innerHeight/3 + (Math.random()-0.5)*120,
      r: 2 + Math.random()*3,
      vx: (Math.random()-0.5)*6,
      vy: -Math.random()*7,
      g: 0.18 + Math.random()*0.22,
      life: 60 + (Math.random()*60|0),
      color: `hsl(${(Math.random()*360)|0} 80% 60%)`
    }));
    drawConfetti();
  }
  function drawConfetti(){
    cctx.clearRect(0,0,confetti.width,confetti.height);
    confs.forEach(p=>{ cctx.beginPath(); cctx.arc(p.x,p.y,p.r,0,Math.PI*2); cctx.fillStyle=p.color; cctx.fill(); p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.life--; });
    confs = confs.filter(p=> p.y < confetti.height+10 && p.life>0 );
    if(confs.length) requestAnimationFrame(drawConfetti);
  }
  addEventListener('resize',()=>{ confetti.width=innerWidth; confetti.height=innerHeight; });

  spinBtn.addEventListener('click', spin);
  refreshBtn.addEventListener('click', ()=>{ items=pickRandom10(pool); drawWheel(); renderList(); resultDom.textContent='已换一批！点开始转～'; });

  drawWheel(); renderList();
</script>
</body>
</html>
